{% extends "./opengis/base.html" %}
{% load opengis_tags %}

{% block head_content %}
<script type="text/javascript">
$(document).ready(function() {
	$(".expand_button").click(function() {
		if($(this).hasClass("expand")) {
			$(this).parent().parent().find("li.collapsible").css("display","inline");
			$(this).html("&#171; Hide Actions").removeClass("expand");
		} else {
			$(this).parent().parent().find("li.collapsible").css("display","none");
			$(this).html("More Actions &#187;").addClass("expand");
		}
		return false;
	});
});
</script>
{% endblock %}

{% block body_content %}
<div class="share_home style_profile">
	<div class="head_nav">
		{% ifequal user account.user %}
			My &#187; <em>Profile</em> | <a href="{% url opengis_list_my_table %}">Tables</a> | <a href="{% url opengis_list_my_query %}">Queries</a>
		{% else %}
			{{account.user.username}} &#187; <em>Profile</em> <span class="back">[<a href="{% url opengis_view_my_home %}">Back to my profile</a>]</span>
		{% endifequal %}
	</div>
	<div class="list_header">{% ifequal user account.user %}<h2>Recent Tables</h2> <span>[ <a href="{% url opengis_create_my_table %}">Create new table</a> ]</span>{% else %}<h2>{{account.user.username}}'s Tables</h2>{% endifequal %}</div>
	{% if not user_tables %}
		<div class="no_list_item">No item found</div>
	{% else %}
		<ol>
			{% for table in user_tables %}
				<li class="item">
					<div class="left_panel">{% print_share_level_html MEDIA_URL table.share_level %}</div>
					<div class="right_panel">
						<h3><a href="{% url opengis_view_my_table table.table_name|urlencode %}">{{table.table_name}}</a> <span class="columns">- ( {{table.columns|join:" , "}} )</span></h3>
						<p class="description">{{table.description|default:'No description'}}</p>
						<p class="tags">tag1 tag2 tag3 tag4</p>
						{% ifequal user account.user %}
						<div class="action_panel">
							<ul>
								<li><a href="{% url opengis_import_my_table table.table_name|urlencode %}">Import Data</a></li>
								<li><a href="{% url opengis_edit_my_table table.table_name|urlencode %}">Edit Table</a></li>
								<li class="warning"><a href="{% url opengis_delete_my_table table.table_name|urlencode %}">Delete</a></li>
							</ul>
						</div>
						{% endifequal %}
					</div>
					<div class="clear"></div>
				</li>
			{% endfor %}
		</ol>
	{% endif %}
	
	<div class="list_header">{% ifequal user account.user %}<h2>Recent Queries</h2> <span>[ <a href="{% url opengis_create_my_query %}">Create new query</a> ]</span>{% else %}<h2>{{account.user.username}}'s Queries</h2>{% endifequal %}</div>
	{% if not user_queries %}
		<div class="no_list_item">No item found</div>
	{% else %}
		<ol>
			{% for query in user_queries %}
				<li class="item">
					<h3><a href="{% url opengis_view_my_query query.query_name|urlencode %}">{{query.query_name}}</a></h3>
					<p class="description">{{query.description|default:'No description'}}</p>
					<div class="action_panel">
						<ul>
							<li><a href="{% my_url opengis_visualize_my_query opengis_visualize_user_query query.query_name|urlencode %}">Visualize</a></li>
							{% ifequal user account.user %}
							<li><a href="#">Get Links</a></li>
							<li><a href="{% url opengis_edit_my_query query.query_name|urlencode %}">Edit Query</a></li>
							<li class="warning"><a href="{% url opengis_delete_my_query query.query_name|urlencode %}">Delete</a></li>
							{% endifequal %}
						</ul>
					</div>
				</li>
			{% endfor %}
		</ol>
	{% endif %}
</div>

{% endblock %}